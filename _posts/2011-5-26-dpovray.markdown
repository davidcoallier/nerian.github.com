---
layout: post
title: "Distributed rendering of an image across multiple computers with DPovray"
---                                                                     

Let go back a couple of months. Let go back to the start of the academic year. September 2010. 

I enrolled in the Distributed System course. I was curious to see how big application can use multiple cores – a cluster of machines – to solve complicated or massive problems.            

So as part of the course we had to build a distributed system. Each team three persons. The technology that we had to use was Java and Corba.

Now if you google what Corba is you will understand very well what my mind thought. In one word: WTF?

Corba is like a Balrog: Ancient, big, heavy, slow. Pure evil.

So I did what I always do. I did a search for alternatives. I didn't had to search much to find better ways to solve the problem concerning the communication between processes on different machines. Specially, above all, I wanted to avoid using Java. I wanted to use Ruby and BrB. 

So I spoke with the professors. They told me that I could do the project in any technology that I wanted, provided that I can find a team that would agree. No problem, I thought, there must be someone who wants to try something new.

No fucking soul answered the call. They said that they only knew Java, that they didn't wanted to learn ruby, that everybody was going to use Java, etc.

My question is: What good is it to learn a technology that you will never ever use because it is so ancient that no new developments are being made? What good is it to use a technology that is slow, error prone, untested, undocumented, heavy and the complete opposite of agile? 

The answer is: They are not software developers. They are sheep.

I had no choice but to join the sheep and build the software using Java and the ominous Corba. It took 4 months to build an application that render povray scenes using many computers. 4 months. 3 developers.

One would be expect a really good piece of software. So long time. So many people. So much 'documentation' in the course slides about Java and Corba. I will say that our application got a 19/20 in the mark, almost perfect. But for me, in the range of good software, it was a complete and utter failure. 0 points. No bullshit.

Here are some reasons:

* Not a single test case.
* We used Subversion. Oh man, I can't count how many problems we have because of retarded SVN.
* We used Corba. Seriously, google about Corba. It creep the hell out of me.

And that are only the software part of the problems. I haven't talked about the methodology. It was almost a joke. First we develop the working software. Then we write the documention – flow diagrams, class diagrams, etc. The test part was irrelevant, nobody did testing.

Now, if you are with in the agile way of developing software you must be feeling a heart attack. We were wasting days writing flow diagrams – which are supposed to help us when we START the development –  AFTER completing the software. Completely absurd. Retarded.

After 4 years of academic projects I can say that today universities need to rethink how they teach. They need to do it asap because the modern world has no use for the people they are training.

At the beginning I told my professor that even if I I was to do the project I Java, I will keep developing the ruby alternative. I wanted to learn Ruby.                       

That was probably one of the best decisions in my life. It is the reason this blog is alive. I read the RSpec book and tried to follow the test driven methodology. I had a lot of mistakes. If I now look at my code I think is some serious shit. That's good, it means I am learning.

But I didn't finished that ruby project. I started other projects – based in Ruby too. I read a lot about Rails; the Web development with ruby on Rails is a very good book. I learned about Capybara, Steak, Cucumber, MongoDB, Redis, RVM, Nginx, Passenger, Heroku, Stackoverflow, Sinatra....

Fiuu, man...what I have learn this year, all by myself, is much more that what I have learn by my formal education in 3 years. I need to make a blog post about education, but now let focus on DPovray.

A week ago I restarted the project. I used what I have learn in the pass months to decide on other technology: Sinatra, Resque and Redis. In a week I finished what it took 4 months and 3 people to do it in Java.

I think the beauty of Ruby is how simple it makes things. It let you focus on choosing the right algorithm, the right way of doing things and doesn't get in your way.

The Java algorithm to merge the images used Swing. It was a hardcoded piece of shit of around 500 lines of code. Heavy. Slow. If you didn't programmed you won't understand what was going on. Actually...I didn't neither.

The Ruby algorithm that I used is capable of merging 200 partial images – total image being 2000x2000 pixels – in less than a second. 4 lines of code. 4 LINES! No use of files. Just an in-memory tail operation thanks to clever use of TGA images and Ruby string manipulation magic.               

Oh, and I used all the libraries I could find to solve my problem. I used JSON to store objects. I started with tests and ended with working software. The documention I have is what the user needs.

I present you DPovray:  <a href='https://github.com/Nerian/DPovray'>https://github.com/Nerian/DPovray</a>

I am sure it could be done better. I am sure it has a lot of things to improve. Raise an issue at github or fork, you can count on me acting on your feedback. For I want to master Ruby land and I do want to be a good developer.
